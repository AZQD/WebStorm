<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>交叉观察器</title>
  <style type="text/css">
    #div1 {
      width: 300px;
      height: 200px;
      overflow-y: auto;
      overflow-x: hidden;
    }

    #div2 {
      height: 800px;
      width: 300px;
      background-color: #ddd;
      overflow: hidden;
      padding-top: 200px;
    }

    .myDiv {
      margin-top: 50px;
      width: 70px;
      height: 70px;
      background-color: pink;
    }
  </style>
</head>

<body>
<div id="div1">
  <div id="div2">
    <div class="myDiv myDiv1">1</div>
    <div class="myDiv myDiv2">2</div>
    <div class="myDiv myDiv3">3</div>
    <div class="myDiv myDiv4">4</div>
    <div class="myDiv myDiv5">5</div>
    <div class="myDiv myDiv6">6</div>
    <div class="myDiv myDiv7">7</div>
    <div class="myDiv myDiv8">8</div>
  </div>
</div>
<script>
    // 示例参考文档：cnblogs.com/yhquan/p/11326038.html
    var observer = new IntersectionObserver(entries => {
        // console.log(entries);
        entries.forEach((item, index) => {
            console.log(item.target, item.intersectionRatio);
            // console.log(item.intersectionRatio <= 0 ? (index+1 + '不可见') : (index+1 +'可见'));
            // if (item.intersectionRatio > 0.7) {
            //     console.log(item.target)
            // }
        });

        // observer.disconnect() // 统计到就不在需要继续观察了
    });

    let newArr = Array.from(document.querySelectorAll("#div2 .myDiv"));
    newArr.forEach(item => observer.observe(item))



    // callback 回调函数
    // option 配置对象
    // var io = new IntersectionObserver(callback, option);

    // 开始观察
    // io.observe(document.getElementById('myDiv'));
    // observe的参数是一个 DOM 节点对象。如果要观察多个节点，就要多次调用这个方法。

    // // 停止观察
    // io.unobserve(document.getElementById('myDiv'));

    // // 关闭观察器
    // io.disconnect();


</script>
</body>

</html>